#pragma once

#include "vivid.h"
#include "switch_id.h"

///============================================================
/// スイッチ系ギミックの基底クラス
/// ・床スイッチ、レバーなどの共通処理を定義
/// ・状態管理は StageManager に委譲する
///============================================================
class ISwitch
{
public:
	//========================================================
	// コンストラクタ
	// width, height : 当たり判定サイズ
	// id            : スイッチ種別ID
	//========================================================
	ISwitch(int width, int height, SWITCH_ID id);

	//========================================================
	// デストラクタ（派生クラス用にvirtual）
	//========================================================
	virtual ~ISwitch(void) = default;

	//========================================================
	// 初期化処理
	// スイッチの配置位置を設定
	//========================================================
	virtual void Initialize(const vivid::Vector2& position);

	//========================================================
	// 更新処理
	// ステージスクロールに追従する共通処理
	//========================================================
	virtual void Update(void);

	//========================================================
	// 描画処理
	// 派生クラスでオーバーライドする
	//========================================================
	virtual void Draw(void);

	//========================================================
	// 解放処理
	// 必要に応じて派生クラスで実装
	//========================================================
	virtual void Finalize(void);

	//========================================================
	// スイッチが押されたときの処理
	//========================================================
	virtual void OnPress(void);

	//========================================================
	// 当たり判定サイズ取得
	//========================================================
	int GetWidth(void);
	int GetHeight(void);

	//========================================================
	// スイッチの現在位置取得
	//========================================================
	vivid::Vector2 GetPosition(void);

	//========================================================
	// スイッチ種別ID取得
	//========================================================
	SWITCH_ID GetSwitchID(void);

	//========================================================
	// スイッチがON状態かどうか取得
	//（StageManagerで一括管理）
	//========================================================
	bool GetOnFlag(void);

protected:
	//========================================================
	// メンバ変数（派生クラスから参照可能）
	//========================================================
	int					m_Width;		// 当たり判定の幅
	int					m_Height;		// 当たり判定の高さ
	vivid::Vector2		m_Position;		// 現在位置
	vivid::Vector2		m_Velocity;		// 移動速度
	SWITCH_ID			m_SwitchID;		// スイッチ種別ID

	//========================================================
	// 共通定数
	//========================================================
	static const float	m_scroll_speed;	// ステージスクロール速度
	static const float	m_friction;		// 移動減衰率
};
