#pragma once

#include "vivid.h"
#include <vector>
#include <string>

///============================================================
/// CSVファイルローダークラス
/// ・CSVファイルを読み込み、セル単位で文字列・整数・浮動小数点を取得可能
/// ・内部データは1次元ベクターに行優先で格納
/// ・列数・行数を自動計算
///============================================================
class CCSVLoader
{
public:
	//========================================================
	// コンストラクタ / デストラクタ
	//========================================================
	CCSVLoader(void);
	~CCSVLoader(void);

	//========================================================
	// CSVファイル読み込み
	// file_name : 読み込むCSVファイルのパス
	// ・コンマ区切りをセルとして m_Data に格納
	// ・行数・列数を計算
	//========================================================
	void Load(const std::string& file_name);

	//========================================================
	// データ解放
	//========================================================
	void Unload(void);

	//========================================================
	// 列数取得
	//========================================================
	int GetCols(void);

	//========================================================
	// 行数取得
	//========================================================
	int GetRows(void);

	//========================================================
	// データ総数取得
	//========================================================
	int GetDataCount(void);

	//========================================================
	// 指定セルの文字列取得
	// rows : 行番号, cols : 列番号
	//========================================================
	std::string GetString(int rows, int cols);

	//========================================================
	// 指定セルを整数として取得
	// 範囲外・空文字・変換失敗時は0を返す
	//========================================================
	int GetInteger(int rows, int cols);

	//========================================================
	// 指定セルを浮動小数点として取得
	// 範囲外・空文字・変換失敗時は0.0fを返す
	//========================================================
	float GetFloat(int rows, int cols);

private:
	using CSV_DATA = std::vector<std::string>;

	CSV_DATA    m_Data;     // 読み込んだCSVデータ（行優先1次元配列）
	int         m_Cols;     // 列数
	int         m_Rows;     // 行数
};
